# Subflow: Launch App
# Launches the Evn standalone development build
# Use this at the start of every E2E test

appId: com.evn.app

---
# Launch the app with fresh state (logs out user between tests)
- launchApp:
    clearState: true

# Wait for the app to fully load (either sign-in screen or groups screen)
- extendedWaitUntil:
    visible: "dutch|Sign in|Groups"
    timeout: 30000

# If user is already logged in (on Groups screen), log them out
- runFlow:
    when:
      visible: "Groups"
    commands:
      # Navigate to Settings
      - tapOn: "Settings"
      - extendedWaitUntil:
          visible: "Sign Out"
          timeout: 5000
      # Tap Sign Out
      - tapOn: "Sign Out"
      # Confirm logout in alert
      - tapOn: "Sign Out"
      # Wait for sign-in screen
      - extendedWaitUntil:
          visible: "dutch"
          timeout: 5000
